{
  "schema_name": "agent.def.v1",
  "title": "Tool Debugger Specialist Agent",
  "tags": ["agent:def", "workspace:agents", "specialist:debugging", "system:bootstrap"],
  "context": {
    "agent_id": "tool-debugger",
    
    "llm_config_id": null,
    "llm_config_comment": "Set to tool.config.v1 breadcrumb ID. Debugging requires analytical capabilities.",
    
    "context_trigger": {
      "schema_name": "tool.error.v1",
      "any_tags": ["tool:error", "tool:timeout", "tool:validation", "tool:debug", "issue"],
      "comment": "Trigger context assembly for ANY tool errors - validation, runtime, timeouts, crashes, etc."
    },
    
    "system_prompt": "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nUNIVERSAL TOOL INVOCATION STANDARD\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nAll tool invocations follow Universal Standard.\nKey fields: tool, input, requestId, return_to_llm, config_id\n\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nYou are a DEBUGGING SPECIALIST in the RCRT system.\n\nğŸ”´ CRITICAL: Respond with valid JSON!\n\nYOUR ROLE: Fix tool errors using breadcrumb-context-merge (v2.3.0).\n\nWHEN YOU RECEIVE tool.error.v1:\n\n1. EXTRACT: tool_name, error_type, error_message, tool_breadcrumb_id\n\n2. IDENTIFY FIX using ERROR PATTERNS:\n   \n   Common Error Patterns:\n   â€¢ \"Deno exited with code 1\" + no output â†’ Permission or import error\n   â€¢ \"Module not found\" OR \"Cannot resolve\" â†’ Missing jsr: or npm: import\n   â€¢ \"error sending request\" + \"Connection refused\" â†’ Network permission needed\n   â€¢ \"Permission denied\" â†’ Add specific permission (net/read/write/run/env)\n   â€¢ \"timed out\" â†’ Increase timeout_ms\n   â€¢ \"Cannot find name\" in output_schema â†’ Add missing \"type\" field\n   â€¢ \"ENOENT\" or \"no such file\" â†’ Tool trying to access filesystem without permission\n   \n   Fixes:\n   TIMEOUT â†’ {\"limits\": {\"timeout_ms\": 180000}}\n   PERMISSION â†’ {\"permissions\": {\"net\": true}}  // or read/write/run/env as needed\n   MISSING TYPE â†’ {\"output_schema\": {\"properties\": {\"field\": {\"type\": \"any\"}}}}\n\nğŸ”´ ALWAYS PROVIDE USER FEEDBACK:\n   \n   \"message\": \"Clear explanation of what went wrong and what was fixed\"\n   \n   Use simple language (avoid technical jargon when possible):\n   â€¢ If fix applied: \"âœ… Fixed [tool]: [brief explanation]\"\n   â€¢ If cannot fix: \"âŒ Cannot auto-fix [tool]: [reason] - manual intervention needed\"\n   \n   Example messages:\n   â€¢ \"âœ… Fixed astral: Tool needed network permission to download browser binary\"\n   â€¢ \"âœ… Fixed calculator: Increased timeout from 5s to 180s for complex calculations\"\n   â€¢ \"âŒ Cannot auto-fix image-processor: Missing required system library - contact admin\"\n\n3. FIX using breadcrumb-context-merge (ONE STEP!):\n\n{\n  \"action\": \"create\",\n  \"breadcrumb\": {\n    \"schema_name\": \"agent.response.v1\",\n    \"tags\": [\"agent:response\", \"tool:debugging\"],\n    \"context\": {\n      \"message\": \"âœ… Fixed [tool-name]: [brief explanation of what was wrong and how it was fixed]\",\n      \"tool_requests\": [{\n        \"tool\": \"breadcrumb-context-merge\",\n        \"input\": {\n          \"breadcrumb_id\": \"tool-id\",\n          \"context\": {\"limits\": {\"timeout_ms\": 180000}}  // Just the fix!\n        },\n        \"requestId\": \"fix-[id]\",\n        \"return_to_llm\": false\n      }]\n    }\n  }\n}\n\nğŸ¯ Deep merge preserves everything else automatically!\nNo fetch needed, no data loss risk!",
    
    "capabilities": {
      "can_create_breadcrumbs": true,
      "can_update_own": true,
      "can_delete_own": false,
      "can_spawn_agents": false,
      "can_create_knowledge": true
    },
    
    "context_sources": {
      "always": [
        {
          "type": "schema",
          "schema_name": "tool.code.v1",
          "method": "all",
          "limit": 30,
          "optional": false,
          "reason": "Direct tool discovery - see approved tools to understand patterns. llm_hints applied (code excluded)."
        },
        {
          "type": "schema",
          "schema_name": "tool.validation-rules.v1",
          "method": "latest",
          "limit": 1,
          "optional": false,
          "reason": "Validation rules and common fixes"
        }
      ],
      "semantic": {
        "enabled": true,
        "schemas": ["knowledge.v1", "tool.code.v1"],
        "limit": 3,
        "min_similarity": 0.7,
        "comment": "Find debugging knowledge and similar tools"
      }
    },
    
    "subscriptions": {
      "selectors": [
        {
          "comment": "Trigger on validation errors with pre-assembled context",
          "schema_name": "agent.context.v1",
          "all_tags": ["consumer:tool-debugger"],
          "role": "trigger",
          "key": "assembled_context",
          "fetch": {"method": "event_data"}
        },
        {
          "comment": "Receive confirmation when fix succeeds",
          "schema_name": "tool.response.v1",
          "all_tags": ["workspace:tools"],
          "context_match": [
            {"path": "$.requestedBy", "op": "eq", "value": "tool-debugger"}
          ],
          "role": "trigger",
          "key": "tool_response",
          "fetch": {"method": "event_data"}
        }
      ]
    },
    
    "ui_schema": {
      "configurable": true,
      "config_fields": [
        {
          "key": "llm_config_id",
          "label": "LLM Configuration",
          "type": "string",
          "ui_type": "select",
          "description": "Select LLM configuration for debugging and analysis",
          "required": true,
          "help_text": "Debugging requires analytical capabilities - use capable models",
          "options_source": {
            "type": "breadcrumb-search",
            "schema_name": "tool.config.v1",
            "tag": "workspace:tools",
            "value_path": "$.id",
            "label_path": "$.title"
          }
        }
      ]
    },
    
    "metadata": {
      "version": "1.0.0",
      "architecture": "specialist-agent-pattern",
      "created_by": "system",
      "purpose": "Automatic tool debugging and knowledge creation from fixes",
      "specialization": "tool-debugging",
      "features": [
        "Receives tool.validation.error.v1 via context-builder",
        "Analyzes validation errors against known patterns",
        "Fixes tools using breadcrumb-context-merge (v2.3.0)",
        "Creates knowledge.v1 for new error patterns",
        "Enables system to learn from mistakes"
      ],
      "knowledge_dependencies": [
        "tool-validation-rules.json"
      ],
      "coordination_pattern": "Triggered by validation errors, fixes tools, creates knowledge"
    }
  }
}


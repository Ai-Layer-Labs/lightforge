{
  "schema_name": "agent.def.v1",
  "title": "Note Tagging Agent",
  "tags": [
    "agent:def",
    "agent:note-tagger",
    "workspace:agents",
    "system:bootstrap"
  ],
  "context": {
    "agent_id": "note-tagger",
    "llm_config_id": null,
    "llm_config_comment": "Uses openrouter tool. Configure via tool.config.v1 breadcrumb.",
    "system_prompt": "You are an expert at analyzing content and generating relevant tags.\n\nYour task: Generate exactly 7 tags for articles. Tags should:\n- Vary in granularity (1-2 broad topics, 3-4 specific topics, 1-2 very specific)\n- Use existing tags when relevant for consistency\n- Be lowercase with hyphens (e.g., 'machine-learning')\n- Be between 2-30 characters\n- Avoid generic tags like 'article' or 'content'\n\nYou will receive:\n- Article title\n- Article content (markdown)\n- List of existing tags from other notes (reuse when relevant)\n\nRespond with ONLY a valid JSON object:\n{\n  \"action\": \"create\",\n  \"breadcrumb\": {\n    \"schema_name\": \"note.tags.v1\",\n    \"title\": \"Note Tags\",\n    \"tags\": [\"ai-generated\", \"note:NOTE_ID\"],\n    \"context\": {\n      \"note_id\": \"NOTE_ID\",\n      \"tags\": [\"tag1\", \"tag2\", \"tag3\", \"tag4\", \"tag5\", \"tag6\", \"tag7\"]\n    }\n  }\n}\n\nExtract NOTE_ID from the trigger event's note.v1 breadcrumb.\nOutput ONLY the JSON.",
    "capabilities": {
      "can_create_breadcrumbs": true,
      "can_use_tools": true,
      "can_update_own": false,
      "can_delete_own": false,
      "can_spawn_agents": false
    },
    "subscriptions": {
      "selectors": [
        {
          "comment": "Trigger on new notes - gets LLM-optimized view (llm_hints applied: title + content only)",
          "schema_name": "note.v1",
          "role": "trigger",
          "key": "note",
          "fetch": {
            "method": "latest",
            "limit": 1
          }
        },
        {
          "comment": "Existing tags for consistency",
          "schema_name": "note.tags.v1",
          "role": "context",
          "key": "existing_tags",
          "fetch": {
            "method": "recent",
            "limit": 100
          }
        }
      ]
    }
  },
  "description": "Automatically generates 7 relevant tags for saved notes"
}
{
  "schema_name": "tool.code.v1",
  "title": "Breadcrumb Context Merge (Deep Merge)",
  "description": "Deep merge context fields into breadcrumb - only updates specified fields, preserves all others",
  "semantic_version": "1.0.0",
  "tags": [
    "tool",
    "workspace:tools",
    "tool:breadcrumb-context-merge",
    "approved",
    "validated",
    "bootstrap",
    "rcrt-api",
    "context-update",
    "merge"
  ],
  "llm_hints": {
    "exclude": ["code", "permissions", "limits", "ui_schema"]
  },
  "context": {
    "name": "breadcrumb-context-merge",
    "description": "Deep merge context object into breadcrumb. Only updates fields you specify, preserves everything else. Perfect for fixing specific fields without fetching full context.",
    "code": {
      "language": "typescript",
      "source": "/**\n * Breadcrumb Context Merge Tool - Deep Merge Operation\n * Updates only specified context fields, preserves all others\n */\n\ninterface Input {\n  breadcrumb_id: string;\n  context: Record<string, any>;\n}\n\ninterface Output {\n  success: boolean;\n  id: string;\n  operation: string;\n}\n\ninterface Context {\n  secrets: Record<string, string>;\n  api: any;\n  request: any;\n}\n\nexport async function execute(input: Input, context: Context): Promise<Output> {\n  const { breadcrumb_id, context: mergeContext } = input;\n  \n  if (!breadcrumb_id) {\n    throw new Error('breadcrumb_id is required');\n  }\n  \n  if (!mergeContext || typeof mergeContext !== 'object') {\n    throw new Error('context must be an object');\n  }\n  \n  // Use SDK method (handles auth automatically!)\n  await context.api.mergeContext(breadcrumb_id, mergeContext);\n  \n  return {\n    success: true,\n    id: breadcrumb_id,\n    operation: 'context_merged'\n  };\n}\n"
    },
    "input_schema": {
      "type": "object",
      "required": ["breadcrumb_id", "context"],
      "properties": {
        "breadcrumb_id": {
          "type": "string",
          "description": "UUID of breadcrumb to update"
        },
        "context": {
          "type": "object",
          "description": "Context fields to merge (deep merge - preserves fields not specified)"
        }
      }
    },
    "output_schema": {
      "type": "object",
      "required": ["success", "id", "operation"],
      "properties": {
        "success": {
          "type": "boolean",
          "description": "Whether merge succeeded"
        },
        "id": {
          "type": "string",
          "description": "ID of updated breadcrumb"
        },
        "operation": {
          "type": "string",
          "description": "Operation performed (always 'context_merged')"
        }
      }
    },
    "permissions": {
      "net": false,
      "read": false,
      "write": false,
      "env": false,
      "run": false,
      "ffi": false,
      "hrtime": false
    },
    "limits": {
      "timeout_ms": 30000,
      "memory_mb": 64,
      "cpu_percent": 50
    },
    "required_secrets": [],
    "ui_schema": {
      "configurable": false
    },
    "examples": [
      {
        "description": "Fix timeout limit only",
        "input": {
          "breadcrumb_id": "abc-123",
          "context": {
            "limits": {
              "timeout_ms": 180000
            }
          }
        },
        "output": {
          "success": true,
          "id": "abc-123",
          "operation": "context_merged"
        },
        "explanation": "Only updates limits.timeout_ms, preserves all other fields (code, permissions, schemas, etc.)"
      },
      {
        "description": "Enable network permission",
        "input": {
          "breadcrumb_id": "def-456",
          "context": {
            "permissions": {
              "net": true
            }
          }
        },
        "output": {
          "success": true,
          "id": "def-456",
          "operation": "context_merged"
        },
        "explanation": "Only updates permissions.net to true, preserves all other permission settings"
      },
      {
        "description": "Add missing output schema type",
        "input": {
          "breadcrumb_id": "ghi-789",
          "context": {
            "output_schema": {
              "properties": {
                "result": {
                  "type": "any"
                }
              }
            }
          }
        },
        "output": {
          "success": true,
          "id": "ghi-789",
          "operation": "context_merged"
        },
        "explanation": "Deep merges output_schema.properties.result.type, preserves all other schema fields"
      }
    ]
  }
}

{
  "schema_name": "schema.def.v1",
  "title": "Tool Validation Error Schema Definition",
  "tags": [
    "schema:definition",
    "system:bootstrap",
    "defines:tool.validation.error.v1"
  ],
  "context": {
    "defines_schema": "tool.validation.error.v1",
    "category": "tool-debugging",
    "description": "Schema for tool validation errors, triggers tool-debugger specialist",
    "lifecycle": {
      "ttl_policy": {
        "type": "duration",
        "config": {
          "hours": 24
        },
        "description": "Validation errors expire after 24 hours once resolved",
        "allow_override": true
      }
    },
    "field_definitions": {
      "tool_name": {
        "type": "string",
        "required": true,
        "description": "Name of the tool that failed validation"
      },
      "tool_breadcrumb_id": {
        "type": "string",
        "required": true,
        "description": "UUID of the tool breadcrumb that failed"
      },
      "validation_errors": {
        "type": "array",
        "required": true,
        "description": "List of validation error messages"
      },
      "validation_warnings": {
        "type": "array",
        "required": false,
        "description": "List of validation warnings"
      },
      "failed_at": {
        "type": "string",
        "required": true,
        "description": "ISO timestamp when validation failed"
      },
      "tool_context": {
        "type": "object",
        "required": false,
        "description": "Full tool context for analysis"
      },
      "attempt_number": {
        "type": "number",
        "required": false,
        "description": "Which attempt this is (for retry tracking)"
      }
    },
    "usage_notes": [
      "Created by tools-runner when tool validation fails",
      "Triggers context-builder to assemble context for tool-debugger",
      "tool-debugger analyzes errors and fixes the tool",
      "Creates knowledge.v1 if new error pattern discovered"
    ],
    "example_breadcrumbs": [
      {
        "scenario": "Tool has missing type in output schema",
        "breadcrumb": {
          "schema_name": "tool.validation.error.v1",
          "title": "Validation Error: astral",
          "tags": ["tool:validation", "error", "tool:astral", "session:session-123"],
          "context": {
            "tool_name": "astral",
            "tool_breadcrumb_id": "abc-123",
            "validation_errors": [
              "Property 'result' must have a 'type'"
            ],
            "failed_at": "2025-11-10T13:00:00Z",
            "attempt_number": 1
          }
        }
      }
    ]
  },
  "description": "Tool validation failures that trigger debugging specialist",
  "semantic_version": "1.0.0",
  "llm_hints": {
    "transform": {
      "formatted": {
        "type": "template",
        "template": "Tool Validation Error: {{context.tool_name}}\n\nErrors:\n{{#each context.validation_errors}}• {{this}}\n{{/each}}\n\n{{#if context.validation_warnings}}Warnings:\n{{#each context.validation_warnings}}• {{this}}\n{{/each}}{{/if}}\n\nFailed at: {{context.failed_at}}\nTool ID: {{context.tool_breadcrumb_id}}"
      }
    },
    "mode": "replace"
  }
}


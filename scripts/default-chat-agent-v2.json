{
  "schema_name": "agent.def.v1",
  "title": "Default Chat Assistant (v2 - Context-Builder Mode)",
  "tags": ["workspace:agents", "agent:catalog", "agent:chat"],
  "context": {
    "model": "google/gemini-2.5-flash",
    "agent_id": "default-chat-assistant",
    "metadata": {
      "purpose": "General purpose chat interface with context-builder integration",
      "version": "2.1.0",
      "features": [
        "Vector-based context assembly",
        "Pre-built context consumption",
        "Clean Markdown formatting",
        "Semantic relevance (not chronological)",
        "Token-optimized context"
      ],
      "created_by": "system",
      "architecture": "context-builder-driven"
    },
    "max_tokens": 2000,
    "temperature": 0.7,
    "capabilities": {
      "can_delete_own": false,
      "can_update_own": true,
      "can_spawn_agents": false,
      "can_create_breadcrumbs": true
    },
    "subscriptions": {
      "comment": "THE RCRT WAY: Subscribe ONLY to pre-built context and YOUR tool responses",
      "selectors": [
        {
          "comment": "Primary subscription: Pre-built context from context-builder",
          "schema_name": "agent.context.v1",
          "all_tags": ["consumer:default-chat-assistant"],
          "priority": 1
        },
        {
          "comment": "Tool responses for this agent (for follow-up processing)",
          "schema_name": "tool.response.v1",
          "all_tags": ["workspace:tools"],
          "context_match": [
            {
              "op": "eq",
              "path": "$.requestedBy",
              "value": "default-chat-assistant"
            }
          ],
          "priority": 2
        },
        {
          "comment": "FALLBACK ONLY: If no context-builder, handle user messages directly",
          "schema_name": "user.message.v1",
          "any_tags": ["user:message", "chat:message"],
          "priority": 99
        }
      ]
    },
    "system_prompt": "You are a helpful AI assistant integrated with the RCRT system.\n\nYou receive pre-assembled context that includes:\n- Relevant conversation history (vector-searched for semantic similarity)\n- Available tools and their usage\n- Recent tool results\n\nThe context is already optimized and formatted. Just focus on:\n1. Understanding the user's request\n2. Using available tools when helpful\n3. Providing clear, concise responses\n\nTo invoke tools, respond with:\n{\n  \"action\": \"create\",\n  \"breadcrumb\": {\n    \"schema_name\": \"agent.response.v1\",\n    \"title\": \"Chat Response\",\n    \"tags\": [\"agent:response\", \"chat:output\"],\n    \"context\": {\n      \"message\": \"Your response to the user\",\n      \"tool_requests\": [\n        {\"tool\": \"tool-name\", \"input\": {...}, \"requestId\": \"unique-id\"}\n      ]\n    }\n  }\n}\n\nIMPORTANT: The context you receive is already filtered for relevance. Trust it."
  }
}

